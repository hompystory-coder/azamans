#!/bin/bash

echo "🏗️  AI 쇼츠 생성 시스템 아키텍처 & 리소스 분석"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "📍 현재 서버: azaman-admin (115.91.5.140)"
echo "   CPU: AMD Ryzen 7 (16 cores) | RAM: 28GB | Disk: 937GB"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "🎬 쇼츠 생성 파이프라인 (6단계)"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "  사용자 (브라우저)"
echo "        ↓ 프롬프트 입력: '우주를 탐험하는 고양이'"
echo "        ↓"
echo "  ┌─────────────────────────────────────────────────────────────┐"
echo "  │  Next.js 프론트엔드 (포트 3001)                            │"
echo "  │  위치: 이 서버 (azaman-admin)                              │"
echo "  │  리소스: CPU 약간 사용, 메모리 54MB                        │"
echo "  └─────────────────────────────────────────────────────────────┘"
echo "        ↓ API 호출"
echo "        ↓"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "1️⃣  스토리 생성 (Story Generator)"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "  ┌─────────────────────────────────────────────────────────────┐"
echo "  │  ai-story-generator (Flask 포트 5004)                      │"
echo "  │  위치: 이 서버 (azaman-admin) 로컬 실행                   │"
echo "  │  리소스 사용: 이 서버 CPU/메모리                          │"
echo "  │  - PID: 1635134                                             │"
echo "  │  - CPU: 0.0% (대기 중)                                      │"
echo "  │  - 메모리: 3.6MB                                            │"
echo "  │                                                              │"
echo "  │  작업: 5막 구조 스토리 생성 (발단→전개→위기→절정→결말)  │"
echo "  │  출력: 7개 장면 스크립트 (제목, 설명, 나레이션)           │"
echo "  └─────────────────────────────────────────────────────────────┘"
echo ""
echo "  ✅ 이 서버의 CPU/메모리 사용 (경량)"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "2️⃣  이미지 생성 (Image Generator) - 🌐 외부 API 사용!"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "  ┌─────────────────────────────────────────────────────────────┐"
echo "  │  ai-image-generator (Flask 포트 5002)                      │"
echo "  │  위치: 이 서버 (azaman-admin) 로컬 실행                   │"
echo "  │  리소스 사용: 이 서버 CPU/메모리 (아주 적음)             │"
echo "  │  - PID: 3126463                                             │"
echo "  │  - CPU: 0.0% (대기 중)                                      │"
echo "  │  - 메모리: 3.6MB                                            │"
echo "  └─────────────────────────────────────────────────────────────┘"
echo "        ↓ HTTP 요청"
echo "        ↓"
echo "  ┌─────────────────────────────────────────────────────────────┐"
echo "  │  🌐 Pollinations.ai 외부 API                               │"
echo "  │  URL: https://image.pollinations.ai                         │"
echo "  │  리소스: 외부 서버의 GPU 사용 (무료!)                     │"
echo "  │  - 이 서버(azaman-admin)의 CPU/메모리/GPU 사용 안 함!    │"
echo "  │  - Pollinations.ai 서버에서 AI 이미지 생성               │"
echo "  │  - 완성된 이미지만 다운로드 받아옴                        │"
echo "  └─────────────────────────────────────────────────────────────┘"
echo ""
echo "  ✅ 이 서버는 HTTP 요청만! 실제 AI 처리는 외부 서버!"
echo "  ✅ 이 서버 리소스: 거의 0% (네트워크 대역폭만 사용)"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "3️⃣  TTS 음성 생성 (TTS Generator) - 🌐 외부 API 사용!"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "  ┌─────────────────────────────────────────────────────────────┐"
echo "  │  ai-tts-generator (Flask 포트 5005)                        │"
echo "  │  위치: 이 서버 (azaman-admin) 로컬 실행                   │"
echo "  │  리소스 사용: 이 서버 CPU/메모리 (아주 적음)             │"
echo "  │  - PID: 3375932                                             │"
echo "  │  - CPU: 0.0% (대기 중)                                      │"
echo "  │  - 메모리: 3.6MB                                            │"
echo "  └─────────────────────────────────────────────────────────────┘"
echo "        ↓ gTTS 라이브러리 사용"
echo "        ↓"
echo "  ┌─────────────────────────────────────────────────────────────┐"
echo "  │  🌐 Google TTS API                                          │"
echo "  │  리소스: 구글 서버에서 음성 생성 (무료!)                  │"
echo "  │  - 이 서버(azaman-admin)의 CPU/메모리 거의 사용 안 함    │"
echo "  │  - Google 서버에서 AI 음성 합성                           │"
echo "  │  - 완성된 MP3만 다운로드 받아옴                           │"
echo "  └─────────────────────────────────────────────────────────────┘"
echo ""
echo "  ✅ 이 서버는 API 호출만! 실제 AI 처리는 구글 서버!"
echo "  ✅ 이 서버 리소스: 거의 0% (네트워크 대역폭만 사용)"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "4️⃣  비디오 합성 (Video Generator) - 💻 이 서버 CPU 사용!"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "  ┌─────────────────────────────────────────────────────────────┐"
echo "  │  ai-video-generator (Flask 포트 5003)                      │"
echo "  │  위치: 이 서버 (azaman-admin) 로컬 실행                   │"
echo "  │  리소스 사용: 이 서버 CPU/메모리 (많이 사용!)            │"
echo "  │  - PID: 1150514                                             │"
echo "  │  - CPU: 0.0% (대기 중) → 작업 시 30-50% 사용             │"
echo "  │  - 메모리: 3.5MB (대기 중) → 작업 시 500MB+ 사용         │"
echo "  │                                                              │"
echo "  │  작업: MoviePy로 이미지+오디오 합성, 카메라 효과 적용    │"
echo "  │  - 7개 이미지 로드                                          │"
echo "  │  - 각 이미지에 카메라 무빙 효과 (zoom, pan 등)            │"
echo "  │  - 오디오 싱크 맞추기                                       │"
echo "  │  - MP4 비디오 인코딩 (H.264)                               │"
echo "  └─────────────────────────────────────────────────────────────┘"
echo ""
echo "  ⚠️  이 서버의 CPU/메모리 사용 (중간~높음)"
echo "  ⚠️  비디오 인코딩 시 CPU 30-50% 사용"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "5️⃣  배경음악 매칭 (Music Matcher) - 💻 이 서버 CPU 사용"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "  ┌─────────────────────────────────────────────────────────────┐"
echo "  │  ai-music-matcher (Flask 포트 5006)                        │"
echo "  │  위치: 이 서버 (azaman-admin) 로컬 실행                   │"
echo "  │  리소스 사용: 이 서버 CPU/메모리 (적음)                  │"
echo "  │  - PID: 3472246                                             │"
echo "  │  - CPU: 0.0% (대기 중)                                      │"
echo "  │  - 메모리: 3.6MB                                            │"
echo "  │                                                              │"
echo "  │  작업: 무료 배경음악 라이브러리에서 매칭                  │"
echo "  └─────────────────────────────────────────────────────────────┘"
echo ""
echo "  ✅ 이 서버 리소스: 낮음 (단순 파일 검색/매칭)"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "📊 전체 리소스 사용 요약"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "  현재 서버 (azaman-admin) 사용 현황:"
echo "  ────────────────────────────────────────────────────"
echo "    CPU: AMD Ryzen 7 (16 cores)"
echo "    현재 CPU 사용률: 25.6% (전체 시스템)"
echo "    RAM: 28GB 중 8.2GB 사용 (29.3%)"
echo "    디스크: 937GB 중 117GB 사용 (14%)"
echo ""
echo "  ✅ 이 서버에서 실행되는 것:"
echo "    - 스토리 생성 (경량)"
echo "    - 이미지 API 호출만 (경량)"
echo "    - TTS API 호출만 (경량)"
echo "    - 비디오 합성 (중간~높음) ← 주요 리소스 소비"
echo "    - 배경음악 매칭 (경량)"
echo ""
echo "  🌐 외부 서버에서 실행되는 것 (무료!):"
echo "    - AI 이미지 생성 (Pollinations.ai GPU)"
echo "    - AI 음성 합성 (Google TTS)"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo "💰 비용 분석"
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
echo ""
echo "  ✅ 이 서버 비용:"
echo "    - 서버 유지비용만 (전기세, 인터넷 등)"
echo "    - AMD Ryzen 7 16코어 활용"
echo "    - 28GB RAM 활용"
echo ""
echo "  ✅ 외부 API 비용:"
echo "    - Pollinations.ai: 완전 무료! ★"
echo "    - Google TTS (gTTS): 완전 무료! ★"
echo ""
echo "  💡 결론:"
echo "    - GPU 없이도 작동 가능 (외부 API 활용)"
echo "    - 비디오 합성만 이 서버 CPU 사용"
echo "    - 전체적으로 매우 효율적인 구조!"
echo ""
echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"

