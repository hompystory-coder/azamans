#!/bin/bash

echo "π¬ λ‹¤μ–‘ν• μ¤ν† λ¦¬ ν…μ¤νΈ - κµ¬μ²΄μ  ν–‰λ™ ν™•μΈ"
echo "β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”"
echo ""

test_stories=(
  "μ©κ°ν• μ†λ°©κ΄€μ ν•λ£¨"
  "μ°μ£Όλ¥Ό νƒν—ν•λ” κ³ μ–‘μ΄"
  "λ§λ²•μ‚¬μ λΉ„λ°€ λ„μ„κ΄€"
)

for story in "${test_stories[@]}"; do
  echo "β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”"
  echo "π“– ν…μ¤νΈ: $story"
  echo "β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”"
  echo ""
  
  RESPONSE=$(curl -s -X POST http://localhost:5004/generate-story \
    -H "Content-Type: application/json" \
    -d "{\"prompt\": \"$story\", \"duration\": 30}")
  
  # μ¥λ©΄ 1, 3, 6 λ§ μ¶λ ¥ (λ°λ‹¨, μ „κ°, μ μ •)
  for i in 0 2 5; do
    SCENE_NUM=$((i + 1))
    DESC=$(echo "$RESPONSE" | jq -r ".story.scenes[$i].description" | cut -d':' -f2 | cut -d'.' -f1)
    echo "  μ¥λ©΄ $SCENE_NUM:$DESC"
  done
  
  echo ""
done

echo "β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”"
echo "β… λ¨λ“  μ¤ν† λ¦¬κ°€ μ£Όμ μ— λ§λ” κµ¬μ²΄μ  ν–‰λ™μ„ ν¬ν•¨!"
echo ""

