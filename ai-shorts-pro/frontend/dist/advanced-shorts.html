<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì‡¼ì¸  ìë™í™” Pro - ê³ ê¸‰ ì„¤ì •</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .auto-save-indicator {
            display: inline-block;
            margin-left: 10px;
            padding: 4px 12px;
            background: #4CAF50;
            color: white;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: normal;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .auto-save-indicator.saving {
            background: #ff9800;
            opacity: 1;
        }

        .auto-save-indicator.saved {
            background: #4CAF50;
            opacity: 1;
        }

        .main-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 15px 30px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            color: #666;
            position: relative;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: #667eea;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            background: #f9f9f9;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #444;
        }

        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .file-upload {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload:hover {
            border-color: #667eea;
            background: #f5f7ff;
        }

        .file-upload input[type="file"] {
            display: none;
        }

        .file-list {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .file-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
        }

        .file-item button {
            background: #ff5252;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .character-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
        }

        .character-card {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .character-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .character-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea10, #764ba210);
        }

        .character-avatar {
            font-size: 3rem;
            margin-bottom: 8px;
        }

        .character-name {
            font-weight: bold;
            margin-bottom: 4px;
        }

        .voice-sample {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .voice-sample audio {
            flex: 1;
            height: 35px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .mode-selector {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .mode-option {
            flex: 1;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mode-option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea10, #764ba210);
        }

        .mode-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .progress-section {
            display: none;
            margin-top: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 12px;
        }

        .progress-section.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .script-preview {
            margin-top: 20px;
        }

        .scene-item {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
        }

        .scene-item.selected {
            border-color: #667eea;
        }

        .scene-image {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
        }

        .scene-content {
            flex: 1;
        }

        .scene-checkbox {
            display: flex;
            align-items: center;
        }

        .video-result {
            margin-top: 20px;
            text-align: center;
        }

        .video-result video {
            max-width: 100%;
            max-height: 600px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .youtube-metadata {
            margin-top: 20px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
        }

        .copy-btn {
            padding: 8px 16px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-left: 10px;
        }

        .slider-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .slider-group input[type="range"] {
            flex: 1;
        }

        .slider-value {
            min-width: 50px;
            text-align: right;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¬ AI ì‡¼ì¸  ìë™í™” Pro
                <span class="auto-save-indicator" id="autoSaveIndicator">ğŸ’¾ ì €ì¥ë¨</span>
            </h1>
            <p>ì „ë¬¸ê°€ê¸‰ ì‡¼ì¸ ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•˜ì„¸ìš”</p>
        </header>

        <div class="main-content">
            <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab('settings')">âš™ï¸ ê¸°ë³¸ ì„¤ì •</button>
                <button class="tab" onclick="switchTab('character')">ğŸ‘¤ ìºë¦­í„° ì„ íƒ</button>
                <button class="tab" onclick="switchTab('create')">ğŸ¥ ì‡¼ì¸  ìƒì„±</button>
                <button class="tab" onclick="switchTab('result')">âœ¨ ê²°ê³¼</button>
            </div>

            <!-- íƒ­ 1: ê¸°ë³¸ ì„¤ì • -->
            <div id="tab-settings" class="tab-content active">
                <div class="section">
                    <div class="section-title">ğŸµ ë°°ê²½ ìŒì•…</div>
                    <div class="form-group">
                        <label class="file-upload" for="bgm-upload">
                            <div>ğŸ“ ë°°ê²½ ìŒì•… íŒŒì¼ ì„ íƒ (MP3, WAV)</div>
                            <input type="file" id="bgm-upload" accept="audio/*" multiple onchange="handleFileUpload(event, 'bgm')">
                        </label>
                        <div class="file-list" id="bgm-list"></div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">ğŸ–¼ï¸ ë°°ê²½ ì´ë¯¸ì§€</div>
                    <div class="form-group">
                        <label class="file-upload" for="bg-upload">
                            <div>ğŸ“ ë°°ê²½ ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ (JPG, PNG)</div>
                            <input type="file" id="bg-upload" accept="image/*" multiple onchange="handleFileUpload(event, 'bg')">
                        </label>
                        <div class="file-list" id="bg-list"></div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">ğŸ¤ ìŒì„± ì„ íƒ (16ê°€ì§€)</div>
                    <div class="form-group">
                        <label>ìŒì„± ìœ í˜•</label>
                        <select id="voice-type" onchange="loadVoiceSamples(); autoSaveSettings();">
                            <optgroup label="ì—¬ì„± ìŒì„± - ì¼ë°˜">
                                <option value="female-friendly">ì¹œê·¼í•œ ì—¬ì„± ìŒì„± (ì¶”ì²œ)</option>
                                <option value="female-energetic">ë°œë„í•œ ì—¬ì„± ìŒì„±</option>
                                <option value="female-professional">ì „ë¬¸ì ì¸ ì—¬ì„± ìŒì„±</option>
                                <option value="female-soft">ë¶€ë“œëŸ¬ìš´ ì—¬ì„± ìŒì„±</option>
                                <option value="female-mature">ì„±ìˆ™í•œ ì—¬ì„± ìŒì„±</option>
                                <option value="female-young">ê·€ì—¬ìš´ ì—¬ì„± ìŒì„±</option>
                            </optgroup>
                            <optgroup label="ì—¬ì„± ìŒì„± - íŠ¹ìˆ˜">
                                <option value="female-news">ë‰´ìŠ¤ ì•µì»¤ ì—¬ì„± ìŒì„±</option>
                                <option value="female-drama">ë“œë¼ë§ˆí‹±í•œ ì—¬ì„± ìŒì„±</option>
                                <option value="female-whisper">ì†ì‚­ì´ëŠ” ì—¬ì„± ìŒì„±</option>
                            </optgroup>
                            <optgroup label="ë‚¨ì„± ìŒì„± - ì¼ë°˜">
                                <option value="male-professional">ì „ë¬¸ì ì¸ ë‚¨ì„± ìŒì„± (ì¶”ì²œ)</option>
                                <option value="male-calm">ì°¨ë¶„í•œ ë‚¨ì„± ìŒì„±</option>
                                <option value="male-energetic">í™œê¸°ì°¬ ë‚¨ì„± ìŒì„±</option>
                                <option value="male-deep">ì¤‘ì €ìŒ ë‚¨ì„± ìŒì„±</option>
                                <option value="male-young">ì Šì€ ë‚¨ì„± ìŒì„±</option>
                                <option value="male-narration">ë‚´ë ˆì´ì…˜ ë‚¨ì„± ìŒì„±</option>
                            </optgroup>
                            <optgroup label="ë‚¨ì„± ìŒì„± - íŠ¹ìˆ˜">
                                <option value="male-powerful">íŒŒì›Œí’€í•œ ë‚¨ì„± ìŒì„±</option>
                                <option value="male-documentary">ë‹¤íë©˜í„°ë¦¬ ë‚¨ì„± ìŒì„±</option>
                            </optgroup>
                            <optgroup label="íŠ¹ìˆ˜ ìŒì„±">
                                <option value="child-friendly">ì•„ë™ìš© ì¹œê·¼í•œ ìŒì„±</option>
                                <option value="elderly-wise">ì–´ë¥´ì‹  ì§€í˜œë¡œìš´ ìŒì„±</option>
                                <option value="robot-ai">AI ë¡œë´‡ ìŒì„±</option>
                                <option value="asmr-relaxing">ASMR íë§ ìŒì„±</option>
                            </optgroup>
                        </select>
                        <div class="voice-sample" id="voice-sample">
                            <!-- ìŒì„± ìƒ˜í”Œì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ìŒì„± ì†ë„</label>
                        <div class="slider-group">
                            <input type="range" id="voice-speed" min="0.5" max="2.0" step="0.1" value="1.0" oninput="updateSliderValue('voice-speed'); autoSaveSettings();">
                            <span class="slider-value" id="voice-speed-value">1.0x</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ìŒì„± í†¤</label>
                        <div class="slider-group">
                            <input type="range" id="voice-pitch" min="-10" max="10" step="1" value="0" oninput="updateSliderValue('voice-pitch'); autoSaveSettings();">
                            <span class="slider-value" id="voice-pitch-value">0</span>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">âœï¸ ìë§‰ ì„¤ì •</div>
                    <div class="form-group">
                        <label>í°íŠ¸</label>
                        <select id="font-select" onchange="autoSaveSettings();">
                            <option value="NanumGothic">ë‚˜ëˆ”ê³ ë”•</option>
                            <option value="NanumGothicBold">ë‚˜ëˆ”ê³ ë”• Bold</option>
                            <option value="NanumMyeongjo">ë‚˜ëˆ”ëª…ì¡°</option>
                            <option value="NotoSansKR">Noto Sans KR</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ìë§‰ í¬ê¸°</label>
                        <div class="slider-group">
                            <input type="range" id="subtitle-size" min="40" max="120" value="75" oninput="updateSliderValue('subtitle-size'); autoSaveSettings();">
                            <span class="slider-value" id="subtitle-size-value">75px</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>ìë§‰ ìœ„ì¹˜ (í•˜ë‹¨ìœ¼ë¡œë¶€í„°)</label>
                        <div class="slider-group">
                            <input type="range" id="subtitle-position" min="100" max="800" value="400" oninput="updateSliderValue('subtitle-position'); autoSaveSettings();">
                            <span class="slider-value" id="subtitle-position-value">400px</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>í…Œë‘ë¦¬ ë‘ê»˜</label>
                        <div class="slider-group">
                            <input type="range" id="subtitle-border" min="0" max="10" value="6" oninput="updateSliderValue('subtitle-border'); autoSaveSettings();">
                            <span class="slider-value" id="subtitle-border-value">6px</span>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">ğŸ“ í”„ë¡¬í”„íŠ¸ ì„¤ì •</div>
                    <div class="form-group">
                        <label>AI ìŠ¤í¬ë¦½íŠ¸ ìƒì„± í”„ë¡¬í”„íŠ¸</label>
                        <textarea id="script-prompt" rows="6" onchange="autoSaveSettings();">ë¸”ë¡œê·¸ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ 30ì´ˆ ë¶„ëŸ‰ì˜ ë§¤ë ¥ì ì¸ ì‡¼ì¸  ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.
- 5ê°œì˜ ì¥ë©´ìœ¼ë¡œ êµ¬ì„±
- ê° ì¥ë©´ì€ 6ì´ˆ ë¶„ëŸ‰
- ì¹œê·¼í•˜ê³  ë§¤ë ¥ì ì¸ í†¤
- í•µì‹¬ ì •ë³´ë¥¼ ëª…í™•í•˜ê²Œ ì „ë‹¬
- ë§ˆì§€ë§‰ì— í–‰ë™ ìœ ë„ ë¬¸êµ¬ í¬í•¨</textarea>
                    </div>
                    <div class="form-group">
                        <label>ì˜ìƒ ì œëª© (ì„ íƒì‚¬í•­)</label>
                        <input type="text" id="video-title" placeholder="ì˜ˆ: ë†€ë¼ìš´ ì œí’ˆ ë¦¬ë·°" onchange="autoSaveSettings();">
                    </div>
                </div>

                <button class="btn btn-primary" onclick="nextTab('character')" style="width: 100%; margin-top: 20px;">
                    ë‹¤ìŒ: ìºë¦­í„° ì„ íƒ â†’
                </button>
            </div>

            <!-- íƒ­ 2: ìºë¦­í„° ì„ íƒ -->
            <div id="tab-character" class="tab-content">
                <div class="section">
                    <div class="section-title">ğŸ‘¥ ìºë¦­í„° ì„ íƒ (10ê°€ì§€)</div>
                    <div class="character-grid" id="character-grid">
                        <!-- ìºë¦­í„°ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">ğŸ¨ ì˜ìƒ ìŠ¤íƒ€ì¼</div>
                    <div class="mode-selector">
                        <div class="mode-option" onclick="selectMode('character')" id="mode-character">
                            <div class="mode-icon">ğŸ‘¤</div>
                            <div><strong>ìºë¦­í„°ë§Œ</strong></div>
                            <div style="font-size: 0.9rem; color: #666;">AI ìƒì„± ìºë¦­í„°</div>
                        </div>
                        <div class="mode-option selected" onclick="selectMode('hybrid')" id="mode-hybrid">
                            <div class="mode-icon">ğŸ­</div>
                            <div><strong>ìºë¦­í„° + ì‹¤ì‚¬</strong></div>
                            <div style="font-size: 0.9rem; color: #666;">í˜¼í•© ìŠ¤íƒ€ì¼</div>
                        </div>
                        <div class="mode-option" onclick="selectMode('realistic')" id="mode-realistic">
                            <div class="mode-icon">ğŸ“¸</div>
                            <div><strong>ì‹¤ì‚¬ë§Œ</strong></div>
                            <div style="font-size: 0.9rem; color: #666;">ë¸”ë¡œê·¸ ì´ë¯¸ì§€</div>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="nextTab('create')" style="width: 100%; margin-top: 20px;">
                    ë‹¤ìŒ: ì‡¼ì¸  ìƒì„± â†’
                </button>
            </div>

            <!-- íƒ­ 3: ì‡¼ì¸  ìƒì„± -->
            <div id="tab-create" class="tab-content">
                <div class="section">
                    <div class="section-title">ğŸ”„ ìƒì„± ëª¨ë“œ</div>
                    <div class="mode-selector">
                        <div class="mode-option selected" onclick="selectGenerationMode('auto')" id="gen-mode-auto">
                            <div class="mode-icon">ğŸ¤–</div>
                            <div><strong>ìë™ ìƒì„±</strong></div>
                            <div style="font-size: 0.9rem; color: #666;">AIê°€ ìë™ìœ¼ë¡œ</div>
                        </div>
                        <div class="mode-option" onclick="selectGenerationMode('manual')" id="gen-mode-manual">
                            <div class="mode-icon">âœ‹</div>
                            <div><strong>ìˆ˜ë™ ìƒì„±</strong></div>
                            <div style="font-size: 0.9rem; color: #666;">ì§ì ‘ ì„ íƒ</div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">ğŸ”— ë¸”ë¡œê·¸/ê¸°ì‚¬ URL</div>
                    <div class="form-group">
                        <input type="text" id="blog-url" placeholder="ì˜ˆ: https://blog.naver.com/..." value="https://blog.naver.com/alphahome/224106828152">
                    </div>
                    <button class="btn btn-secondary" onclick="crawlBlog()">ğŸ“¥ í¬ë¡¤ë§ ì‹œì‘</button>
                </div>

                <div class="section" id="script-preview-section" style="display: none;">
                    <div class="section-title">ğŸ“‹ ìŠ¤í¬ë¦½íŠ¸ ë¯¸ë¦¬ë³´ê¸°</div>
                    <div class="script-preview" id="script-preview">
                        <!-- ìŠ¤í¬ë¦½íŠ¸ì™€ ì´ë¯¸ì§€ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                    <button class="btn btn-primary" onclick="generateScenes()" style="margin-top: 15px;">
                        âœ… ì„ íƒí•œ ì¥ë©´ìœ¼ë¡œ ì˜ìƒ ìƒì„±
                    </button>
                </div>

                <div class="progress-section" id="progress-section">
                    <h3 style="margin-bottom: 15px;">â³ ìƒì„± ì§„í–‰ ì¤‘...</h3>
                    <div id="progress-message">ì¤€ë¹„ ì¤‘...</div>
                    <div class="progress-bar">
                        <div class="progress-bar-fill" id="progress-bar">0%</div>
                    </div>
                </div>
            </div>

            <!-- íƒ­ 4: ê²°ê³¼ -->
            <div id="tab-result" class="tab-content">
                <div class="section">
                    <div class="section-title">ğŸ‰ ìƒì„± ì™„ë£Œ!</div>
                    <div class="video-result" id="video-result">
                        <p>ì˜ìƒì´ ìƒì„±ë˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
                    </div>
                </div>

                <div class="section" id="youtube-section" style="display: none;">
                    <div class="section-title">ğŸ“º ìœ íŠœë¸Œ ì—…ë¡œë“œ ì •ë³´</div>
                    <div class="youtube-metadata">
                        <div class="form-group">
                            <label>ì œëª©</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="yt-title" readonly style="flex: 1;">
                                <button class="copy-btn" onclick="copyToClipboard('yt-title')">ğŸ“‹ ë³µì‚¬</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>ì„¤ëª…</label>
                            <div style="display: flex; gap: 10px;">
                                <textarea id="yt-description" readonly rows="6" style="flex: 1;"></textarea>
                                <button class="copy-btn" onclick="copyToClipboard('yt-description')">ğŸ“‹ ë³µì‚¬</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>í‚¤ì›Œë“œ</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="yt-tags" readonly style="flex: 1;">
                                <button class="copy-btn" onclick="copyToClipboard('yt-tags')">ğŸ“‹ ë³µì‚¬</button>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="resetAll()" style="width: 100%; margin-top: 20px;">
                    ğŸ”„ ìƒˆë¡œìš´ ì‡¼ì¸  ë§Œë“¤ê¸°
                </button>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ìƒíƒœ
        const state = {
            settings: {
                bgm: [],
                backgrounds: [],
                voice: 'female-friendly',
                voiceSpeed: 1.0,
                voicePitch: 0,
                font: 'NanumGothicBold',
                subtitleSize: 75,
                subtitlePosition: 400,
                subtitleBorder: 6,
                prompt: '',
                videoTitle: ''
            },
            character: null,
            videoMode: 'hybrid',
            generationMode: 'auto',
            blogUrl: '',
            crawledData: null,
            scripts: [],
            selectedScenes: [],
            finalVideo: null
        };

        // ìë™ ì €ì¥ ë””ë°”ìš´ìŠ¤ íƒ€ì´ë¨¸
        let autoSaveTimer = null;

        // LocalStorage í‚¤
        const STORAGE_KEY = 'ai_shorts_settings';

        // ìŒì„± ìƒ˜í”Œ í…ìŠ¤íŠ¸ ë§¤í•‘ (16ê°€ì§€ ìŒì„±)
        const voiceSamples = {
            // ì—¬ì„± ìŒì„± - ì¼ë°˜
            'female-friendly': 'ì•ˆë…•í•˜ì„¸ìš”! ì €ëŠ” ì¹œê·¼í•œ ì—¬ì„± ìŒì„±ì´ì—ìš”. ì´ ìŒì„±ìœ¼ë¡œ ì‡¼ì¸ ë¥¼ ë§Œë“¤ì–´ë“œë¦´ê²Œìš”!',
            'female-energetic': 'ì•ˆë…•! ë‚˜ëŠ” ë°œë„í•œ ì—¬ì„± ìŒì„±ì´ì•¼! ì¬ë¯¸ìˆê³  í™œê¸°ì°¬ ì‡¼ì¸ ë¥¼ ë§Œë“¤ì–´ì¤„ê²Œ!',
            'female-professional': 'ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ. ì „ë¬¸ì ì¸ ì—¬ì„± ìŒì„±ì…ë‹ˆë‹¤. ì‹ ë¢°ê° ìˆëŠ” ë‚´ìš©ì„ ì „ë‹¬í•˜ê² ìŠµë‹ˆë‹¤.',
            'female-soft': 'ì•ˆë…•í•˜ì„¸ìš”... ë¶€ë“œëŸ¬ìš´ ì—¬ì„± ìŒì„±ì´ì—ìš”. í¸ì•ˆí•˜ê²Œ ë“¤ë ¤ë“œë¦´ê²Œìš”.',
            'female-mature': 'ì•ˆë…•í•˜ì„¸ìš”. ì„±ìˆ™í•œ ì—¬ì„± ìŒì„±ì…ë‹ˆë‹¤. ê¹Šì´ ìˆëŠ” ë‚´ìš©ì„ ì „ë‹¬í•´ë“œë¦½ë‹ˆë‹¤.',
            'female-young': 'ì•ˆë…•í•˜ì„¸ìš©! ê·€ì—¬ìš´ ì—¬ì„± ìŒì„±ì´ì—ìš©! ì¦ê±°ìš´ ì‡¼ì¸ ë¥¼ ë§Œë“¤ì–´ìš”!',
            
            // ì—¬ì„± ìŒì„± - íŠ¹ìˆ˜
            'female-news': 'ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ. ë‰´ìŠ¤ ì•µì»¤ ì—¬ì„± ìŒì„±ì…ë‹ˆë‹¤. ëª…í™•í•˜ê³  ê¶Œìœ„ ìˆê²Œ ì „ë‹¬í•˜ê² ìŠµë‹ˆë‹¤.',
            'female-drama': 'ì•ˆë…•í•˜ì„¸ìš”! ë“œë¼ë§ˆí‹±í•œ ì—¬ì„± ìŒì„±ì´ì—ìš”! ê°ë™ì ì¸ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ë“œë¦´ê²Œìš”!',
            'female-whisper': 'ì•ˆë…•í•˜ì„¸ìš”... ì†ì‚­ì´ëŠ” ì—¬ì„± ìŒì„±ì´ì—ìš”... í¸ì•ˆí•˜ê³  ì¡°ìš©í•˜ê²Œ ì „ë‹¬í• ê²Œìš”...',
            
            // ë‚¨ì„± ìŒì„± - ì¼ë°˜
            'male-professional': 'ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ. ì „ë¬¸ì ì¸ ë‚¨ì„± ìŒì„±ì…ë‹ˆë‹¤. ì‹ ë¢°ê° ìˆëŠ” ë‚´ë ˆì´ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤.',
            'male-calm': 'ì•ˆë…•í•˜ì„¸ìš”. ì°¨ë¶„í•œ ë‚¨ì„± ìŒì„±ì…ë‹ˆë‹¤. í¸ì•ˆí•˜ê³  ì•ˆì •ì ì¸ ë¶„ìœ„ê¸°ë¥¼ ë§Œë“¤ì–´ë“œë¦½ë‹ˆë‹¤.',
            'male-energetic': 'ì•ˆë…•í•˜ì„¸ìš”! í™œê¸°ì°¬ ë‚¨ì„± ìŒì„±ì…ë‹ˆë‹¤! ì—ë„ˆì§€ ë„˜ì¹˜ëŠ” ì‡¼ì¸ ë¥¼ ë§Œë“¤ì–´ë“œë¦¬ê² ìŠµë‹ˆë‹¤!',
            'male-deep': 'ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ. ì¤‘ì €ìŒ ë‚¨ì„± ìŒì„±ì…ë‹ˆë‹¤. ê¹Šì´ ìˆê³  ë¬µì§í•œ ëŠë‚Œì„ ì „ë‹¬í•©ë‹ˆë‹¤.',
            'male-young': 'ì•ˆë…•í•˜ì„¸ìš”! ì Šì€ ë‚¨ì„± ìŒì„±ì…ë‹ˆë‹¤! íŠ¸ë Œë””í•˜ê³  í™œë°œí•œ ë‚´ìš©ì„ ì „ë‹¬í•´ìš”!',
            'male-narration': 'ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ. ë‚´ë ˆì´ì…˜ ì „ë¬¸ ë‚¨ì„± ìŒì„±ì…ë‹ˆë‹¤. ëª…í™•í•˜ê³  ì •í™•í•œ ì „ë‹¬ì„ ì•½ì†ë“œë¦½ë‹ˆë‹¤.',
            
            // ë‚¨ì„± ìŒì„± - íŠ¹ìˆ˜
            'male-powerful': 'ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ! íŒŒì›Œí’€í•œ ë‚¨ì„± ìŒì„±ì…ë‹ˆë‹¤! ê°•ë ¬í•˜ê³  í˜ìˆê²Œ ì „ë‹¬í•˜ê² ìŠµë‹ˆë‹¤!',
            'male-documentary': 'ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ. ë‹¤íë©˜í„°ë¦¬ ë‚¨ì„± ìŒì„±ì…ë‹ˆë‹¤. ê¹Šì´ ìˆê³  ì§€ì ì¸ ë‚´ìš©ì„ ì „ë‹¬í•©ë‹ˆë‹¤.',
            
            // íŠ¹ìˆ˜ ìŒì„±
            'child-friendly': 'ì•ˆë…•! ì¹œê·¼í•œ ì•„ë™ìš© ìŒì„±ì´ì•¼! ì¬ë¯¸ìˆê²Œ ë†€ë©´ì„œ ë°°ì›Œë³´ì!',
            'elderly-wise': 'ì•ˆë…•í•˜ì‹œì˜¤. ì–´ë¥´ì‹ ì˜ ì§€í˜œë¡œìš´ ìŒì„±ì´ì˜¤. ê²½í—˜ì—ì„œ ìš°ëŸ¬ë‚˜ì˜¨ ë§ì”€ì„ ì „í•˜ê² ì†Œ.',
            'robot-ai': 'ì•ˆë…•í•˜ì„¸ìš”. ì €ëŠ” AI ë¡œë´‡ ìŒì„±ì…ë‹ˆë‹¤. ì •í™•í•˜ê³  ë…¼ë¦¬ì ì¸ ì •ë³´ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.',
            'asmr-relaxing': 'ì•ˆë…•í•˜ì„¸ìš”... í¸ì•ˆí•œ ASMR íë§ ìŒì„±ì´ì—ìš”... ì°¨ë¶„í•˜ê³  í‰ì˜¨í•˜ê²Œ ë“¤ë ¤ë“œë¦´ê²Œìš”...'
        };

        // ì´ˆê¸°í™”
        window.onload = function() {
            loadCharacters();
            loadVoiceSamples();
            loadSavedSettings();
        };

        // ì €ì¥ëœ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
        function loadSavedSettings() {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    const savedSettings = JSON.parse(saved);
                    
                    // ì„¤ì •ê°’ ë³µì›
                    if (savedSettings.voice) {
                        document.getElementById('voice-type').value = savedSettings.voice;
                        state.settings.voice = savedSettings.voice;
                    }
                    
                    if (savedSettings.voiceSpeed) {
                        document.getElementById('voice-speed').value = savedSettings.voiceSpeed;
                        updateSliderValue('voice-speed');
                    }
                    
                    if (savedSettings.voicePitch !== undefined) {
                        document.getElementById('voice-pitch').value = savedSettings.voicePitch;
                        updateSliderValue('voice-pitch');
                    }
                    
                    if (savedSettings.font) {
                        document.getElementById('font-select').value = savedSettings.font;
                        state.settings.font = savedSettings.font;
                    }
                    
                    if (savedSettings.subtitleSize) {
                        document.getElementById('subtitle-size').value = savedSettings.subtitleSize;
                        updateSliderValue('subtitle-size');
                    }
                    
                    if (savedSettings.subtitlePosition) {
                        document.getElementById('subtitle-position').value = savedSettings.subtitlePosition;
                        updateSliderValue('subtitle-position');
                    }
                    
                    if (savedSettings.subtitleBorder !== undefined) {
                        document.getElementById('subtitle-border').value = savedSettings.subtitleBorder;
                        updateSliderValue('subtitle-border');
                    }
                    
                    if (savedSettings.prompt) {
                        document.getElementById('script-prompt').value = savedSettings.prompt;
                    }
                    
                    if (savedSettings.videoTitle) {
                        document.getElementById('video-title').value = savedSettings.videoTitle;
                    }
                    
                    console.log('âœ… ì €ì¥ëœ ì„¤ì •ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.');
                    showAutoSaveIndicator('saved');
                }
            } catch (error) {
                console.error('ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', error);
            }
        }

        // ìë™ ì €ì¥ í•¨ìˆ˜
        function autoSaveSettings() {
            // ë””ë°”ìš´ì‹± (500ms í›„ ì €ì¥)
            clearTimeout(autoSaveTimer);
            
            showAutoSaveIndicator('saving');
            
            autoSaveTimer = setTimeout(() => {
                try {
                    // í˜„ì¬ ì„¤ì •ê°’ ìˆ˜ì§‘
                    const settings = {
                        voice: document.getElementById('voice-type').value,
                        voiceSpeed: parseFloat(document.getElementById('voice-speed').value),
                        voicePitch: parseInt(document.getElementById('voice-pitch').value),
                        font: document.getElementById('font-select').value,
                        subtitleSize: parseInt(document.getElementById('subtitle-size').value),
                        subtitlePosition: parseInt(document.getElementById('subtitle-position').value),
                        subtitleBorder: parseInt(document.getElementById('subtitle-border').value),
                        prompt: document.getElementById('script-prompt').value,
                        videoTitle: document.getElementById('video-title').value,
                        timestamp: new Date().toISOString()
                    };
                    
                    // LocalStorageì— ì €ì¥
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(settings));
                    
                    // state ì—…ë°ì´íŠ¸
                    state.settings = { ...state.settings, ...settings };
                    
                    console.log('ğŸ’¾ ì„¤ì •ì´ ìë™ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    showAutoSaveIndicator('saved');
                    
                } catch (error) {
                    console.error('ìë™ ì €ì¥ ì‹¤íŒ¨:', error);
                }
            }, 500);
        }

        // ìë™ ì €ì¥ í‘œì‹œê¸°
        function showAutoSaveIndicator(status) {
            const indicator = document.getElementById('autoSaveIndicator');
            
            if (status === 'saving') {
                indicator.textContent = 'ğŸ’¾ ì €ì¥ ì¤‘...';
                indicator.className = 'auto-save-indicator saving';
            } else if (status === 'saved') {
                indicator.textContent = 'âœ… ì €ì¥ë¨';
                indicator.className = 'auto-save-indicator saved';
                
                // 3ì´ˆ í›„ ìë™ìœ¼ë¡œ ìˆ¨ê¹€
                setTimeout(() => {
                    indicator.style.opacity = '0';
                }, 3000);
            }
        }

        // 10ê°€ì§€ ìºë¦­í„° ë°ì´í„°
        const characters = [
            { id: 'sophia', name: 'ì†Œí”¼ì•„', emoji: 'ğŸ‘©â€ğŸ’¼', desc: 'ì¹œê·¼í•œ ì‡¼í•‘ ë„ìš°ë¯¸', voice: 'female-friendly' },
            { id: 'james', name: 'ì œì„ìŠ¤', emoji: 'ğŸ‘¨â€ğŸ’¼', desc: 'ì „ë¬¸ ë¹„ì¦ˆë‹ˆìŠ¤ ì „ë¬¸ê°€', voice: 'male-professional' },
            { id: 'mina', name: 'ë¯¸ë‚˜', emoji: 'ğŸ‘§', desc: 'ë°œë„í•œ ì¸í”Œë£¨ì–¸ì„œ', voice: 'female-energetic' },
            { id: 'david', name: 'ë°ì´ë¹—', emoji: 'ğŸ§‘â€ğŸ«', desc: 'ì°¨ë¶„í•œ êµìœ¡ì', voice: 'male-calm' },
            { id: 'lisa', name: 'ë¦¬ì‚¬', emoji: 'ğŸ‘©â€ğŸ¨', desc: 'ì°½ì˜ì ì¸ ì•„í‹°ìŠ¤íŠ¸', voice: 'female-soft' },
            { id: 'kevin', name: 'ì¼€ë¹ˆ', emoji: 'ğŸ‘¨â€ğŸ’»', desc: 'ê¸°ìˆ  ì „ë¬¸ê°€', voice: 'male-young' },
            { id: 'yuna', name: 'ìœ ë‚˜', emoji: 'ğŸ‘©â€ğŸ³', desc: 'ìš”ë¦¬ ì „ë¬¸ê°€', voice: 'female-mature' },
            { id: 'alex', name: 'ì•Œë ‰ìŠ¤', emoji: 'ğŸ‘¨â€ğŸ¤', desc: 'ì—”í„°í…Œì´ë„ˆ', voice: 'male-energetic' },
            { id: 'emma', name: 'ì— ë§ˆ', emoji: 'ğŸ‘©â€âš•ï¸', desc: 'ê±´ê°• ì „ë¬¸ê°€', voice: 'female-professional' },
            { id: 'mike', name: 'ë§ˆì´í¬', emoji: 'ğŸ‘¨â€âœˆï¸', desc: 'ì—¬í–‰ ê°€ì´ë“œ', voice: 'male-narration' }
        ];

        // ìºë¦­í„° ë¡œë“œ
        function loadCharacters() {
            const grid = document.getElementById('character-grid');
            grid.innerHTML = characters.map(char => `
                <div class="character-card" onclick="selectCharacter('${char.id}')">
                    <div class="character-avatar">${char.emoji}</div>
                    <div class="character-name">${char.name}</div>
                    <div style="font-size: 0.85rem; color: #666;">${char.desc}</div>
                </div>
            `).join('');
        }

        // ìºë¦­í„° ì„ íƒ
        function selectCharacter(id) {
            state.character = id;
            document.querySelectorAll('.character-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // ì„ íƒí•œ ìºë¦­í„°ì˜ ìŒì„±ìœ¼ë¡œ ìë™ ë³€ê²½
            const character = characters.find(c => c.id === id);
            if (character && character.voice) {
                document.getElementById('voice-type').value = character.voice;
                loadVoiceSamples();
                autoSaveSettings();
            }
        }

        // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        function handleFileUpload(event, type) {
            const files = Array.from(event.target.files);
            const listId = type === 'bgm' ? 'bgm-list' : 'bg-list';
            const list = document.getElementById(listId);
            
            files.forEach(file => {
                if (type === 'bgm') {
                    state.settings.bgm.push(file);
                } else {
                    state.settings.backgrounds.push(file);
                }
                
                const item = document.createElement('div');
                item.className = 'file-item';
                item.innerHTML = `
                    <span>${file.name}</span>
                    <button onclick="removeFile('${type}', '${file.name}')">ì‚­ì œ</button>
                `;
                list.appendChild(item);
            });
        }

        // íŒŒì¼ ì‚­ì œ
        function removeFile(type, filename) {
            if (type === 'bgm') {
                state.settings.bgm = state.settings.bgm.filter(f => f.name !== filename);
                document.getElementById('bgm-list').innerHTML = '';
                state.settings.bgm.forEach(f => handleFileUpload({target: {files: [f]}}, 'bgm'));
            } else {
                state.settings.backgrounds = state.settings.backgrounds.filter(f => f.name !== filename);
                document.getElementById('bg-list').innerHTML = '';
                state.settings.backgrounds.forEach(f => handleFileUpload({target: {files: [f]}}, 'bg'));
            }
        }

        // ìŒì„± ìƒ˜í”Œ ë¡œë“œ
        function loadVoiceSamples() {
            const voiceType = document.getElementById('voice-type').value;
            const sampleDiv = document.getElementById('voice-sample');
            const sampleText = voiceSamples[voiceType] || voiceSamples['female-friendly'];
            
            // í˜„ì¬ ì„¤ì •ê°’ ê°€ì ¸ì˜¤ê¸°
            const voiceSpeed = document.getElementById('voice-speed') ? parseFloat(document.getElementById('voice-speed').value) : 1.0;
            const voicePitch = document.getElementById('voice-pitch') ? parseInt(document.getElementById('voice-pitch').value) : 0;
            
            sampleDiv.innerHTML = `
                <div style="margin-top: 15px; display: flex; align-items: center; gap: 10px; padding: 15px; background: white; border-radius: 8px; border: 1px solid #e0e0e0;">
                    <div style="flex: 1;">
                        <div style="font-size: 0.9rem; color: #666; margin-bottom: 5px;">ìƒ˜í”Œ í…ìŠ¤íŠ¸:</div>
                        <div style="font-size: 0.95rem; color: #333;">"${sampleText}"</div>
                        <div style="font-size: 0.85rem; color: #999; margin-top: 8px;">
                            âš™ï¸ í˜„ì¬ ì„¤ì •: ì†ë„ ${voiceSpeed.toFixed(1)}x, í†¤ ${voicePitch > 0 ? '+' : ''}${voicePitch}
                        </div>
                    </div>
                    <button class="btn btn-secondary" onclick="playVoiceSample()" style="padding: 10px 20px; white-space: nowrap;" id="play-sample-btn">
                        â–¶ï¸ ë¯¸ë¦¬ë“£ê¸°
                    </button>
                </div>
                <audio id="voice-sample-audio" style="display: none;"></audio>
            `;
        }

        // Web Audio API ì»¨í…ìŠ¤íŠ¸ (ì „ì—­)
        let audioContext = null;
        let currentSource = null;

        async function playVoiceSample() {
            const voiceType = document.getElementById('voice-type').value;
            const playBtn = document.getElementById('play-sample-btn');
            
            // ì‚¬ìš©ì ì„¤ì •ê°’ ê°€ì ¸ì˜¤ê¸°
            const voiceSpeed = parseFloat(document.getElementById('voice-speed').value);
            const voicePitch = parseInt(document.getElementById('voice-pitch').value);
            
            try {
                playBtn.disabled = true;
                playBtn.textContent = 'â³ ë¡œë”© ì¤‘...';
                
                // ì´ì „ ì¬ìƒ ì¤‘ì§€
                if (currentSource) {
                    currentSource.stop();
                    currentSource = null;
                }
                
                // Web Audio API ì»¨í…ìŠ¤íŠ¸ ìƒì„± (í•œ ë²ˆë§Œ)
                if (!audioContext) {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                }
                
                // APIì—ì„œ ìŒì„± ìƒ˜í”Œ ê°€ì ¸ì˜¤ê¸°
                const sampleUrl = `/api/advanced/voice/sample/${voiceType}`;
                const response = await fetch(sampleUrl);
                const arrayBuffer = await response.arrayBuffer();
                const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
                
                // AudioBufferSource ìƒì„±
                currentSource = audioContext.createBufferSource();
                currentSource.buffer = audioBuffer;
                
                // ì†ë„ ì„¤ì • (playbackRate)
                currentSource.playbackRate.value = voiceSpeed;
                
                // Pitch ì¡°ì ˆì„ ìœ„í•œ detune ì„¤ì • (100 cents = 1 semitone)
                // voicePitch: -10 ~ +10 â†’ detune: -1000 ~ +1000 cents
                currentSource.detune.value = voicePitch * 100;
                
                // ì¶œë ¥ ì—°ê²°
                currentSource.connect(audioContext.destination);
                
                // ì¬ìƒ ì‹œì‘
                currentSource.start(0);
                
                playBtn.textContent = `ğŸ”Š ì¬ìƒ ì¤‘... (ì†ë„: ${voiceSpeed.toFixed(1)}x, í†¤: ${voicePitch > 0 ? '+' : ''}${voicePitch})`;
                
                // ì¬ìƒ ì¢…ë£Œ ì²˜ë¦¬
                currentSource.onended = () => {
                    playBtn.textContent = 'â–¶ï¸ ë¯¸ë¦¬ë“£ê¸°';
                    playBtn.disabled = false;
                    currentSource = null;
                };
                
            } catch (error) {
                console.error('Voice sample playback error:', error);
                alert('ìŒì„± ìƒ˜í”Œì„ ì¬ìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                playBtn.textContent = 'â–¶ï¸ ë¯¸ë¦¬ë“£ê¸°';
                playBtn.disabled = false;
                if (currentSource) {
                    currentSource = null;
                }
            }
        }

        // ìŠ¬ë¼ì´ë” ê°’ ì—…ë°ì´íŠ¸
        function updateSliderValue(id) {
            const slider = document.getElementById(id);
            const valueSpan = document.getElementById(id + '-value');
            
            if (id === 'voice-speed') {
                valueSpan.textContent = parseFloat(slider.value).toFixed(1) + 'x';
            } else if (id === 'voice-pitch') {
                const value = parseInt(slider.value);
                valueSpan.textContent = value > 0 ? `+${value}` : value.toString();
            } else {
                valueSpan.textContent = slider.value + 'px';
            }
            
            // ìŒì„± ì†ë„ë‚˜ í†¤ì´ ë³€ê²½ë˜ë©´ ë¯¸ë¦¬ë“£ê¸° ì •ë³´ ì—…ë°ì´íŠ¸
            if (id === 'voice-speed' || id === 'voice-pitch') {
                loadVoiceSamples();
            }
        }

        // ëª¨ë“œ ì„ íƒ
        function selectMode(mode) {
            state.videoMode = mode;
            document.querySelectorAll('.mode-option').forEach(opt => opt.classList.remove('selected'));
            document.getElementById('mode-' + mode).classList.add('selected');
        }

        function selectGenerationMode(mode) {
            state.generationMode = mode;
            document.querySelectorAll('#gen-mode-auto, #gen-mode-manual').forEach(opt => opt.classList.remove('selected'));
            document.getElementById('gen-mode-' + mode).classList.add('selected');
        }

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.currentTarget.classList.add('active');
            document.getElementById('tab-' + tabName).classList.add('active');
        }

        function nextTab(tabName) {
            switchTab(tabName);
            document.querySelector(`.tab[onclick="switchTab('${tabName}')"]`).classList.add('active');
        }

        // ë¸”ë¡œê·¸ í¬ë¡¤ë§
        async function crawlBlog() {
            const url = document.getElementById('blog-url').value;
            if (!url) {
                alert('ë¸”ë¡œê·¸ URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            updateProgress('ë¸”ë¡œê·¸ í¬ë¡¤ë§ ì¤‘...', 10);
            document.getElementById('progress-section').classList.add('active');

            try {
                const response = await fetch('/api/crawler/crawl', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url })
                });

                const data = await response.json();
                state.crawledData = data.data || data;

                updateProgress('AI ìŠ¤í¬ë¦½íŠ¸ ìƒì„± ì¤‘...', 30);
                await generateScript();

            } catch (error) {
                alert('í¬ë¡¤ë§ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                document.getElementById('progress-section').classList.remove('active');
            }
        }

        // ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
        async function generateScript() {
            try {
                const response = await fetch('/api/advanced/generate-script', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        content: state.crawledData,
                        prompt: state.settings.prompt || document.getElementById('script-prompt').value,
                        character: state.character,
                        mode: state.videoMode
                    })
                });

                const data = await response.json();
                state.scripts = data.scenes;

                displayScriptPreview();
                updateProgress('ìŠ¤í¬ë¦½íŠ¸ ìƒì„± ì™„ë£Œ!', 50);

            } catch (error) {
                alert('ìŠ¤í¬ë¦½íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ìŠ¤í¬ë¦½íŠ¸ ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
        function displayScriptPreview() {
            const preview = document.getElementById('script-preview');
            preview.innerHTML = state.scripts.map((scene, index) => `
                <div class="scene-item" onclick="toggleScene(${index})">
                    <img class="scene-image" src="${scene.image || '/placeholder.jpg'}" alt="Scene ${index + 1}">
                    <div class="scene-content">
                        <h4>ì¥ë©´ ${index + 1}</h4>
                        <p>${scene.text}</p>
                        <small>ì˜ˆìƒ ì‹œê°„: ${scene.duration || 6}ì´ˆ</small>
                    </div>
                    <div class="scene-checkbox">
                        <input type="checkbox" checked>
                    </div>
                </div>
            `).join('');

            document.getElementById('script-preview-section').style.display = 'block';
            state.selectedScenes = state.scripts.map((_, i) => i);
        }

        // ì¥ë©´ ì„ íƒ í† ê¸€
        function toggleScene(index) {
            const checkbox = event.currentTarget.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
            
            if (checkbox.checked) {
                if (!state.selectedScenes.includes(index)) {
                    state.selectedScenes.push(index);
                }
            } else {
                state.selectedScenes = state.selectedScenes.filter(i => i !== index);
            }

            event.currentTarget.classList.toggle('selected', checkbox.checked);
        }

        // ì¥ë©´ ìƒì„±
        async function generateScenes() {
            if (state.selectedScenes.length === 0) {
                alert('ìµœì†Œ 1ê°œ ì´ìƒì˜ ì¥ë©´ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            updateProgress('ë¹„ë””ì˜¤ ì¥ë©´ ìƒì„± ì¤‘... (Minimax Hailuo 2.3)', 60);

            try {
                const response = await fetch('/api/advanced/generate-video', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        scenes: state.selectedScenes.map(i => state.scripts[i]),
                        settings: state.settings,
                        character: state.character,
                        mode: state.videoMode
                    })
                });

                const data = await response.json();

                if (data.success) {
                    updateProgress('ìµœì¢… ë Œë”ë§ ì¤‘... (FFmpeg)', 90);
                    await checkVideoStatus(data.jobId);
                } else {
                    throw new Error(data.error || 'ë¹„ë””ì˜¤ ìƒì„± ì‹¤íŒ¨');
                }

            } catch (error) {
                alert('ë¹„ë””ì˜¤ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ë¹„ë””ì˜¤ ìƒíƒœ í™•ì¸
        async function checkVideoStatus(jobId) {
            const maxAttempts = 60;
            let attempts = 0;

            const interval = setInterval(async () => {
                attempts++;

                try {
                    const response = await fetch(`/api/advanced/status/${jobId}`);
                    const data = await response.json();

                    if (data.status === 'completed') {
                        clearInterval(interval);
                        updateProgress('ì™„ë£Œ!', 100);
                        showResult(data);
                    } else if (data.status === 'failed') {
                        clearInterval(interval);
                        throw new Error(data.error || 'ìƒì„± ì‹¤íŒ¨');
                    }

                    if (attempts >= maxAttempts) {
                        clearInterval(interval);
                        throw new Error('íƒ€ì„ì•„ì›ƒ');
                    }

                } catch (error) {
                    clearInterval(interval);
                    alert('ìƒíƒœ í™•ì¸ ì¤‘ ì˜¤ë¥˜: ' + error.message);
                }
            }, 5000);
        }

        // ê²°ê³¼ í‘œì‹œ
        function showResult(data) {
            state.finalVideo = data;
            
            const videoResult = document.getElementById('video-result');
            videoResult.innerHTML = `
                <video controls autoplay>
                    <source src="${data.videoUrl}" type="video/mp4">
                </video>
                <div style="margin-top: 15px;">
                    <a href="${data.videoUrl}" class="btn btn-primary" download>â¬‡ï¸ ë‹¤ìš´ë¡œë“œ</a>
                </div>
            `;

            // ìœ íŠœë¸Œ ë©”íƒ€ë°ì´í„° í‘œì‹œ
            document.getElementById('yt-title').value = data.youtubeTitle || '';
            document.getElementById('yt-description').value = data.youtubeDescription || '';
            document.getElementById('yt-tags').value = data.youtubeTags || '';
            document.getElementById('youtube-section').style.display = 'block';

            nextTab('result');
        }

        // ì§„í–‰ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateProgress(message, percent) {
            document.getElementById('progress-message').textContent = message;
            const bar = document.getElementById('progress-bar');
            bar.style.width = percent + '%';
            bar.textContent = percent + '%';
        }

        // í´ë¦½ë³´ë“œ ë³µì‚¬
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            element.select();
            document.execCommand('copy');
            alert('ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ì´ˆê¸°í™”
        function resetAll() {
            if (confirm('ëª¨ë“  ì„¤ì •ì„ ì´ˆê¸°í™”í•˜ê³  ì²˜ìŒë¶€í„° ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                location.reload();
            }
        }
    </script>
</body>
</html>
