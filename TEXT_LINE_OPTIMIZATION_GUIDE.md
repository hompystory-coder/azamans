# 📝 자막 및 제목 1줄 표시 최적화

## ✅ 완료된 작업

자막과 제목을 **1줄 우선**으로 표시하되, 너무 길 경우에만 자동으로 2줄로 나누도록 개선했습니다.

---

## 🎯 **변경 사항**

### **이전 동작** ❌
- 20자 이상이면 무조건 2줄로 분리
- 짧은 텍스트도 불필요하게 2줄로 표시
- 제목이 길어도 그대로 사용

### **현재 동작** ✅
- **1줄 우선 정책** (가독성 최적화)
- 텍스트 길이에 따라 자동 조정
- 제목 자동 축약 (20자 제한)

---

## 📏 **텍스트 길이 기준**

### 🎬 **자막 (Subtitle)**

| 텍스트 길이 | 표시 방식 | 예시 |
|------------|----------|------|
| **0-37자** | 1줄 표시 ✅ | "크리스마스가 다가왔습니다" (12자) |
| **38자 이상** | 2줄 자동 분리 | "올해는 특별한 트리로 분위기를 내보세요<br>고급스러운 블랙 컬러가 돋보입니다" |

**계산식**: `maxChars * 1.5 = 25 * 1.5 = 37.5자`

### 📺 **제목 (Title)**

| 텍스트 길이 | 표시 방식 | 예시 |
|------------|----------|------|
| **0-22자** | 1줄 표시 ✅ | "크리스마스 트리 추천" (11자) |
| **23자 이상** | 2줄 자동 분리 | "올해 가장 인기 있는<br>크리스마스 트리" |
| **21자 이상 (생성)** | 자동 축약 ✂️ | "2024년 최고의 크리스마스..." (원본 30자 → 20자) |

**계산식**: `maxChars * 1.5 = 15 * 1.5 = 22.5자`

---

## 🔧 **동작 방식**

### 1. **텍스트 분석**
```javascript
// 1줄 최대 길이 계산
const singleLineMaxLength = maxCharsPerLine * 1.5;

// 예: 자막 25 * 1.5 = 37.5자
// 예: 제목 15 * 1.5 = 22.5자
```

### 2. **길이 비교**
```javascript
if (text.length <= singleLineMaxLength) {
  return [text];  // 1줄 표시 ✅
} else {
  // 2줄로 균등 분리
}
```

### 3. **2줄 분리 로직** (필요 시)
- 공백 기준으로 단어 분리
- 균등하게 2줄로 배분
- 너무 불균형하면 재조정

---

## 📊 **실제 예시**

### ✅ **예시 1: 짧은 자막 (1줄 표시)**
```
입력: "크리스마스가 다가왔습니다" (12자)
출력: 1줄
┌────────────────────────────────┐
│ 크리스마스가 다가왔습니다        │
└────────────────────────────────┘
```

### ✅ **예시 2: 중간 길이 자막 (1줄 표시)**
```
입력: "올해는 특별한 트리로 분위기를 내보세요" (19자)
출력: 1줄
┌────────────────────────────────────┐
│ 올해는 특별한 트리로 분위기를 내보세요 │
└────────────────────────────────────┘
```

### ✅ **예시 3: 긴 자막 (2줄 자동 분리)**
```
입력: "올해는 특별한 트리로 분위기를 내보세요. 고급스러운 블랙 컬러가 돋보입니다" (41자)
출력: 2줄
┌─────────────────────────────────┐
│ 올해는 특별한 트리로 분위기를    │
│ 내보세요. 고급스러운 블랙 컬러가  │
└─────────────────────────────────┘
```

### ✅ **예시 4: 제목 자동 축약**
```
입력: "2024년 가장 인기 있는 크리스마스 트리 TOP 10" (25자)
스크립트 생성 시 축약: "2024년 가장 인기 있는 크..." (20자)
출력: 1줄
┌──────────────────────────┐
│ 2024년 가장 인기 있는 크... │
└──────────────────────────┘
```

---

## 🎨 **백엔드 로그 예시**

### 1줄 표시 (짧은 텍스트)
```
🎨 [자막 필터 생성] 원본 텍스트: "크리스마스가 다가왔습니다"
   ✅ 1줄 표시 (12자 ≤ 37.5자): "크리스마스가 다가왔습니다"
   분리된 줄: 1줄 ["크리스마스가 다가왔습니다"]
```

### 2줄 분리 (긴 텍스트)
```
🎨 [자막 필터 생성] 원본 텍스트: "올해는 특별한 트리로 분위기를 내보세요. 고급스러운 블랙 컬러가 돋보입니다"
   📏 텍스트가 길어서 2줄로 분리 (41자 > 37.5자)
   ⚖️ 균형 재조정: 첫줄 19자, 둘째줄 22자
   ✅ 2줄 분리 완료:
      1줄: "올해는 특별한 트리로 분위기를"
      2줄: "내보세요. 고급스러운 블랙 컬러가"
```

### 제목 축약
```
🎬 [제목 필터 생성] 원본 텍스트: "2024년 가장 인기 있는 크리스마스 트리 TOP 10"
📝 제목 축약: "2024년 가장 인기 있는 크리스마스 트리 TOP 10" → "2024년 가장 인기 있는 크..."
   ✅ 1줄 표시 (20자 ≤ 22.5자)
```

---

## 🎯 **최적화 포인트**

### ✅ **가독성 향상**
- 1줄 표시로 깔끔한 화면 구성
- 불필요한 줄바꿈 제거
- 모바일 화면에서 더 잘 보임

### ✅ **자동 적응**
- 텍스트 길이에 따라 자동 조정
- 짧은 텍스트 = 1줄
- 긴 텍스트 = 2줄 (균등 분배)

### ✅ **제목 최적화**
- 스크립트 생성 시 자동으로 20자로 축약
- "..." 추가로 생략 표시
- 제목이 너무 길면 가독성 저하 방지

---

## 📱 **권장 텍스트 길이**

### 🎬 **자막**
| 상황 | 권장 길이 | 설명 |
|------|----------|------|
| **최적** | 15-25자 | 1줄에 딱 맞는 길이 |
| **허용** | 26-37자 | 1줄 표시 (약간 긴 편) |
| **2줄** | 38자 이상 | 자동으로 2줄 분리 |

### 📺 **제목**
| 상황 | 권장 길이 | 설명 |
|------|----------|------|
| **최적** | 10-15자 | 임팩트 있는 짧은 제목 |
| **허용** | 16-22자 | 1줄 표시 |
| **축약** | 23자 이상 | 20자로 자동 축약 |

---

## 🔧 **커스터마이징**

텍스트 길이 기준을 조정하려면 `videoRenderer.js`의 `splitTextIntoTwoLines` 함수를 수정하세요:

### 자막 길이 조정
```javascript
// backend/src/utils/videoRenderer.js (line 309)
const lines = this.splitTextIntoTwoLines(text, 25);  // 25를 조정
// 25 → 30: 1줄 최대 45자 (30 * 1.5)
// 25 → 20: 1줄 최대 30자 (20 * 1.5)
```

### 제목 길이 조정
```javascript
// backend/src/utils/videoRenderer.js (line 385)
const lines = this.splitTextIntoTwoLines(text, 15);  // 15를 조정
// 15 → 20: 1줄 최대 30자 (20 * 1.5)
// 15 → 10: 1줄 최대 15자 (10 * 1.5)
```

### 제목 축약 길이 조정
```javascript
// backend/src/routes/script.js (line 114)
if (shortTitle.length > 20) {  // 20을 조정
  shortTitle = shortTitle.substring(0, 20) + '...';
}
```

---

## 🧪 **테스트 방법**

### 1. **자막 테스트**
```
1. https://shorts.neuralgrid.kr/ 접속
2. 블로그 URL 입력 (크롤링)
3. 스크립트 생성
4. 음성 생성
5. 비디오 생성 → 자막 확인
```

### 2. **제목 테스트**
```
1. 긴 제목의 블로그 글 크롤링
2. 스크립트 생성 시 제목이 20자로 축약되는지 확인
3. 비디오 생성 → 제목이 1줄로 표시되는지 확인
```

### 3. **백엔드 로그 확인**
```bash
cd /home/azamans/shorts-creator-pro
pm2 logs shorts-creator-backend --nostream --lines 100 | grep "줄 표시"
```

---

## 📊 **결과**

### **Before** ❌
```
제목: 2024년 최고의 크리스마스 트리 장식 아이디어
      TOP 10 추천
자막: 크리스마스가
      다가왔습니다
```

### **After** ✅
```
제목: 2024년 최고의 크리스마스...
자막: 크리스마스가 다가왔습니다
```

---

## 💰 **비용**

이 기능은 **완전 무료**입니다! 로컬 텍스트 처리만 사용합니다.

```
텍스트 분석:  ₩0
줄 분리:      ₩0
제목 축약:    ₩0
──────────────────
총 비용:     ₩0
```

---

## 🎉 **혜택**

✅ **깔끔한 화면**: 1줄 표시로 더 깨끗한 쇼츠 영상
✅ **가독성 향상**: 모바일에서 더 잘 읽힘
✅ **자동 최적화**: 텍스트 길이에 따라 자동 조정
✅ **제목 간결화**: 20자 이내로 자동 축약
✅ **비용 절감**: 추가 비용 없음 (₩0)

---

*최종 업데이트: 2024-12-22*
*Git Commit: dfce1c0*
*관련 파일: backend/src/utils/videoRenderer.js, backend/src/routes/script.js*
